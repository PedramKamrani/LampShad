function addToCart(n,t,i,r){let u=$.cookie(cookieName);u=u===undefined?[]:JSON.parse(u);const f=$("#productCount").val(),e=u.find(t=>t.id===n);if(e!==undefined)u.find(t=>t.id===n).count=parseInt(e.count)+parseInt(f);else{const e={id:n,name:t,unitPrice:i,picture:r,count:f};u.push(e)}$.cookie(cookieName,JSON.stringify(u),{expires:2,path:"/"});updateCart()}function updateCart(){let n=$.cookie(cookieName);n=JSON.parse(n);$("#cart_items_count").text(n.length);$("#cart_items_countm").text(n.length);const t=$("#cart_items_wrapper");t.html("");n.forEach(n=>{const i=`<div class="single-cart-item">
                            <a href="javascript:void(0)" class="remove-icon" onclick="removeFromCart('${n.id}')">
                                <i class="ion-android-close"></i>
                            </a>
                            <div class="image">
                                <a href="single-product.html">
                                    <img src="/ProductPictures/${n.picture}"
                                         class="img-fluid" alt="">
                                </a>
                            </div>
                            <div class="content">
                                <p class="product-title">
                                    <a href="single-product.html">محصول: ${n.name}</a>
                                </p>
                                <p class="count">تعداد: ${n.count}</p>
                                <p class="count">قیمت واحد: ${n.unitPrice}</p>
                            </div>
                        </div>`;t.append(i)})}function removeFromCart(n){let t=$.cookie(cookieName);t=JSON.parse(t);const i=t.findIndex(t=>t.id===n);t.splice(i,1);$.cookie(cookieName,JSON.stringify(t),{expires:2,path:"/"});updateCart()}function changeCartItemCount(n,t,i){var r=$.cookie(cookieName);r=JSON.parse(r);const u=r.findIndex(t=>t.id==n);r[u].count=i;const f=r[u],e=parseInt(f.unitPrice)*parseInt(i);$(`#${t}`).text(e);$.cookie(cookieName,JSON.stringify(r),{expires:2,path:"/"});updateCart();const o={url:"https://www.pkshop2020.ir/api/inventory",method:"POST",timeout:0,headers:{"Content-Type":"application/json"},data:JSON.stringify({productId:n,count:i})};$.ajax(o).done(function(t){if(t.isStock==!1){const i=$("#productStockWarnings");$(`#${n}`).length==0&&i.append(`
                    <div class="alert alert-warning" id="${n}">
                        <i class="fa fa-warning"></i> کالای
                        <strong>${t.productName}</strong>
                        در انبار کمتر از تعداد درخواستی موجود است.
                    </div>
                `)}else $(`#${n}`).length>0&&$(`#${n}`).remove()})}function ViewPageFooter(){function t(){n.send("nottifywatching")}function i(){console.log("Connection.");t()}function r(){console.log("connection Faild.")}var n=(new signalR.HubConnectionBuilder).withUrl("/Hubs/View").build();n.on("ViewCountUpdate",n=>{var t=document.getElementById("ViewConter");t.innerText=n.toString()});n.start().then(i,r)}var cookieName="cart-items";